17 de Mayo

  Tratando de instalar PHAME con conda pro hay muchos errores.
      conda install phame <--- No sirve
--------------------------------------------------------------------------------------------------------------------------------------------------------
  Instalando de forma alternativa creando un nuevo ambiente y usando el repositorio disponible en github: https://github.com/LANL-Bioinformatics/PhaME

      Create a separate conda environment:

        conda create -n phame_env
        
      Install required dependencies into the environment

        conda install -c bioconda perl-bioperl -n phame_env --yes
        conda install -c bioconda samtools bcftools -n phame_env --yes
        conda install -c bioconda mummer -n phame_env --yes
        conda install -c bioconda bowtie2 -n phame_env --yes
        conda install -c bioconda bwa -n phame_env --yes
        conda install -c bioconda fasttree -n phame_env --yes
        conda install -c bioconda bbmap -n phame_env --yes
        conda install -c bioconda raxml -n phame_env --yes
        conda install -c bioconda perl-parallel-forkmanager -n phame_env --yes
        conda install -c bioconda iqtree -n phame_env --yes
        conda install -c bioconda perl-statistics-distributions -n phame_env --yes
        conda install -c bioconda paml -n phame_env --yes
        conda install -c bioconda mafft -n phame_env --yes
        conda install -c bioconda hyphy -n phame_env --yes ***
        
      ***
          For Linux 64, Open MPI is built with CUDA awareness but this support is disabled by default.
          To enable it, please set the environment variable OMPI_MCA_opal_cuda_support=true before
          launching your MPI processes. Equivalently, you can set the MCA parameter in the command line:
          mpiexec --mca opal_cuda_support 1 ...

          In addition, the UCX support is also built but disabled by default.
          To enable it, first install UCX (conda install -c conda-forge ucx). Then, set the environment
          variables OMPI_MCA_pml="ucx" OMPI_MCA_osc="ucx" before launching your MPI processes.
          Equivalently, you can set the MCA parameters in the command line:
          mpiexec --mca pml ucx --mca osc ucx ...
          Note that you might also need to set UCX_MEMTYPE_CACHE=n for CUDA awareness via UCX.
          Please consult UCX's documentation for detail.

      
      Clone the latest github repo:

        git clone https://github.com/LANL-Bioinformatics/PhaME.git
        
      Then test phame to see if the installation was complete using a short test run:

        source activate phame_env
        cd PhaME
        test/TestAll.sh 1

      El test corre sin errores.
--------------------------------------------------------------------------------------------------------------------------------------------------------
  Instalé orthofinder usando el repositorio: https://github.com/davidemms/OrthoFinder
  
  y todo bien. Revsando el manual.
========================================================================================================================================================
18 de MAYO

    Pruebo correr phame como lo indica el manual: https://github.com/LANL-Bioinformatics/PhaME/tree/master/docs/introduction (runphame.rst)
    pero sale un error:
    readdir() attempted on invalid dirhandle DIR at ./src/phame line 217, <CTL>
      line 1 (#1)
        (W io) The dirhandle you're reading from is either closed or not really
        a dirhandle.  Check your control flow.

    Use of uninitialized value in concatenation (.) or string at ./src/phame line
      218, <CTL> line 1 (#2)
        (W uninitialized) An undefined value was used as if it were already
        defined.  It was interpreted as a "" or a 0, but maybe it was a mistake.
        To suppress this warning assign a defined value to your variables.

        To help you figure out what was undefined, perl will try to tell you
        the name of the variable (if any) that was undefined.  In some cases
        it cannot do this, so it also tells you what operation you used the
        undefined value in.  Note, however, that perl optimizes your program
        and the operation displayed in the warning may not necessarily appear
        literally in your program.  For example, "that $foo" is usually
        optimized into "that " . $foo, and the warning will refer to the
        concatenation (.) operator, even though there is no . in
        your program.

    closedir() attempted on invalid dirhandle DIR at ./src/phame line 220, <CTL>
      line 1 (#3)
        (W io) The dirhandle you tried to close is either closed or not really
        a dirhandle.  Check your control flow.

    readdir() attempted on invalid dirhandle DIR at ./src/phame line 217, <CTL>
      line 2 (#1)
    Use of uninitialized value in concatenation (.) or string at ./src/phame line
      218, <CTL> line 2 (#2)
    closedir() attempted on invalid dirhandle DIR at ./src/phame line 220, <CTL>
      line 2 (#3)
    readdir() attempted on invalid dirhandle DIR at ./src/phame line 217, <CTL>
      line 3 (#1)
    Use of uninitialized value in concatenation (.) or string at ./src/phame line
      218, <CTL> line 3 (#2)
    closedir() attempted on invalid dirhandle DIR at ./src/phame line 220, <CTL>
      line 3 (#3)
    PhaME v1.0.5 
    Uncaught exception from user code:
      No such file or directory at /home/biocomp/software/PhaME/src/../lib/PhaME.pm line 931.
      PhaME::PickRefGenome("/home/biocomp/software/PhaME/workdir", "/home/biocomp/software/PhaME/ref", "/home/biocomp/software/PhaME/workdir/results/ecoli.error", "/home/biocomp/software/PhaME/workdir/results/ecoli.log", "/home/biocomp/software/PhaME/workdir/sketch_output.txt") called at ./src/phame line 294
--------------------------------------------------------------------------------------------------------------------------------------------------------
    revisando el test, el error esta en el archivo .ctl
    
    
20 de mayo

Descargué ete toolkit en con conda en un nuevo ambiente (ete3):

      conda activate ete3
      
tuve un error al iniciar el ambiente: esto lo soluciona

      source ~/anaconda3/etc/profile.d/conda.sh
      conda activate ete3
      
      
23 de MAYO

revise ETE toolkit para hacer y analizar filogenias
dado que orthofinder necesita la lista de proteinas, descargue las secuencias codificantes en .faa 
al fin pude correr orthofinder
El clado que me pasaron contiene dos especies mas:"Calothrix_sp._NIES-2098" y "Calothrix_sp._PCC_7507"
Hice un arbol sin estas especies para ver si el arbol era el mismo.
El arbol fue el mismo.
Hare un arbol extra con las dos especies extra

24 de mayo

Estoy escribiendo un script en perl para obtener la abundancia de HIP
Los arboles pasados solo estan hechos con algunos de los cromosomas de las especies ya que no me fije que no tome en cuenta todo el material genetico
Ahora estoy tratando de hallar la forma de descargar todo el genoma anotado (aa) en formato fasta para volver a hacer los arboles
Tambien estoy buscando la forma de obtener la longitud completa del genoma (con los plasmidos) 

Una idea es quitar los encabezados de cada archivo.fasta y contar el numero de caracteres

26 de MAYO

Quitar los encabezados de cada archivo.fasta y contar el numero de caracteres:

  sed '/^>/d' Calothrix_sp._336_3.fasta >out.without.head.txt

O sumar las longitudfes de los archivos de genebank

Otro detalle es que ahora que tengo los datos de proteinas de cada genoma.
Debo saber si es valido combinarlos para tener un solo archivo por genoma y posteriormente meterlo a orthofinder

30 de MAYO
Codigo de conteo de la longitud del genoma
codigo de conteo de HIP

31 de MAYO
codigo para obtener fastas.

1 de Junio
Revisando como obtener los ortogrupos de 3 genomas que no pude obtener del NCBI
Al revisar el conteo de HIP obtenido previamente me di cuenta que tienen numeros muy grandes.
Revisando la ecuación del conteo.

2 de Junio
Escribiendo un nuevo script del conteo
Me di cuenta que habia otro posible sesgo en el conteo: Los saltos de linea en el archivo fasta.
A cada archivo fasta le quite el encabezado y sustitui cada salto de linea por "nada" para que fuera una sola linea.
El script funciona, pero aun no logro entender el significado de la frecuencia observada:
  No se si se refiere a una frecuencia relativa o al conteo esperado.

3 de junio
Leyendo el paper:
  Determination of Bias in the Relative Abundance of Oligonucleotides in DNA Sequences
  Jeff Elhai
Lei que existia otro sesgo en el conteo: el de oligonucleotidos no contiguos.

  Me puse a contar en un archivo con 3 HIP's traslapados: "GCGATCGCGATCGCGATCGC" usando el buscador del editor de texto y usando grep (grep -o 'GCGATCGC' pal.txt | wc -l)
  Ambas busquedas solo em detectaron 2 HIP's.
Buscare mas al respecto.

4 de Junio
En el articulo:
Determination of Bias in the Relative Abundance of Oli gonucleotides in DNA Sequences
  Jeff Elhai
Hablan de la ecuacion para determinar la fecuencia de un oligonucleotido propuesta por: Karlin et al. [1992]
Sin embargo, esta ecuación se basa unicamente en CONTEOS y no en FRECUENCIAS.
Ademas, ahi mismo se explica que despues de obtener esa frecuencia esperada E_M,
solo basta con  multiplicar por el numero total de nucleotidos (es decir la longitud de la secuencia)
para obtener el numero de oligonucleótidos esperado.

Entonces en el script de conteo use dos enfoques (conteo esperado a base de FRECUENCIAS y CONTEOS) con 4 modelos de markov de 1er a 4to orden cada uno.
Ademas agregue un conteo mas usando N-k+1 en lugarv de N para ver las diferencias.

Al revisar los valores obtenidos era evidente que,
el CONTEO ESPERADO en base a FRECUENCIAS usando N-K+1
el CONTEO ESPERADO en base a FRECUENCIAS usando N y
la FRECUENCIA ESPERADA en base a CONTEOS,
Los valores obtenidos son PRACTICAMENTE LOS MISMOS:
[($f_GC*$f_CG*$f_GA*$f_AT*$f_TC*$f_CG*$f_GC)/($f_C*$f_G*$f_A*$f_T*$f_C*$f_G)]*($long_genoma-8+1)
[($f_GC*$f_CG*$f_GA*$f_AT*$f_TC*$f_CG*$f_GC)/($f_C*$f_G*$f_A*$f_T*$f_C*$f_G)]*$long_genoma = 
 ($c_GC*$c_CG*$c_GA*$c_AT*$c_TC*$c_CG*$c_GC)/($c_C*$c_G*$c_A*$c_T*$c_C*$c_G) .....................................(A)
 
PORQUE?
Si reacomodamos la ecuación dejando un PRODUCTO entre el CONTEO de DINUC y NUC
{ [(1/N-1)^n-1]*(N_w1,w2)*(N_w2,w3)*...*(N_Wn-1,wn) / [(1/N)^(n-2)]*(N_w2)*(N_w3)*...*(N_wn-2)} * (N-n+1)       ......(B)
=>
[ (N_w1,w2)*(N_w2,w3)*...*(N_Wn-1,wn) / (N_w2)*(N_w3)*...*(N_wn-2)]¨* [(1/N-1)^(n-1)]/[(1/N)^(n-2)]*(N-n+1)  ......(C)

n = 8
N = 6283267
(C)
[ (N_w1,w2)*(N_w2,w3)*...*(N_W7,w8) / (N_w2)*(N_w3)*...*(N_w6) ] * [(1/6283266)⁷/(1/6283267)⁶]*6283260 
[ (N_w1,w2)*(N_w2,w3)*...*(N_W7,w8) / (N_w2)*(N_w3)*...*(N_w6) ] * 0.99999999999

Si sacamos el limite cuando N tienede a infinito para un oligo de de n bases:

Limit[[(1/x-1)^(y-1)]/[(1/x)^(y-2)]*(x-y+1),x->inf]

tenemos entonces que:
(1/N-1)^(n-1)]/[(1/N)^(n-2)]*(N-n+1) = 1

Ademas si sacamos el mismo limite cuando usamos N en lugar de n-k+1, tambien tiende a 1
entonces podemos concluir que (A) es cierto.
  
5 de Junio
6 de Junio
7 de Junio
8 de junio
# To activate this environment, use
#
#     $ conda activate dgenies
#
# To deactivate an active environment, use
#
#     $ conda deactivate


#
# To activate this environment, use
#
#     $ conda activate anvio-7.1
#
# To deactivate an active environment, use
#
#     $ conda deactivate

13 de junio
he estado buscando opciones de alineación de genomas completos pero la mayoria ya no tienen mantrenimiento o estan basados en java y tienen muchos bugs
Aun asi he estado tratando de correr todos.
Al final siemprellegu a mummer pero tengo porblemas para instalar y replicar los resultados.
Aqui algunas opciones que he checado:
https://dot.sandbox.bio/
https://github.com/marianattestad/dot
https://github.com/dnanexus/dot
https://github.com/marianattestad/ribbon
http://higlass.io/examples
https://docs.higlass.io/
9 de Junio
10 de Junio
14 de junio
he estado experimentando con algunas librerias para hacer filogenias con gradientes de color para caracteristicas
ggtree y phytools producen graficos muy buenos.
Algunas funciones usan arboles en formato nexus. Actualmente desconozco casi totalmente este formato.
buscare algunos ejemplos y vere si puedo convertir los arboles de nwk a nex
es interesante el formato nex ya que puede cargar información sobre el arbol dentro del mismo archivo.
Creo que puede llegar a ser util ya que en la mayoria de los ejemplos que vi adjuntan la alineación multiple.

15 de junio
Encontré una forma de hacer filogenias con ggtree 
el grafico se ve con un degradado de color que va de acuerdo con algun parametro de alguna caracteristica que se indique
en este caso use la abundancia de HIP para diferenciar las especies de acuerdo a su abundancia
Para hacer este grafico se usa un metodo que estima los estados ancestrales. 
Este metodo es con la funcion fitAnc() (reconstrucción rápida del estado ancestral de máxima verosimilitud de caracteres continuos.)
  DESCRIPCION DEL MODELO: https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5395464/
Tambien hay un modelo bayesiano para la reconstrucción: anc.Bayes()
Tengo algunos problemas para extrapolar estos resultados al arbol que habia obtenido con fastAnc()
pude poner estos resultados en el nuevo arbol y se ven mas factibles que los obtenidos con fastAnc()


16 de junio
-instalanddo mummer4
-la version de conda no funciona para mostrar los plots
-descargue la version source
***
Compilation & Installation
To compile and install:

./configure --prefix=/path/to/installation
make
make install
If --prefix is omitted, the software is installed in /usr/local. One may need sudo make install if installing in a system location.

If compiling from the git tree, do autoreconf -fi first.
***
-el sofytware mummerplot no funciona
-Faltaba gnuplot, por eso no funcionaba
-instalé con apt get pero no funcionó, creo que es porque es una version no actualizada
-descargue el source de gnuplot, funciona pero  mummerplot no lo localiza
-El codigo de mummerplot llama a la carpeta bin, por lo que lo cambie por la ubicacion en donde instale mummer
-todo bien.

17 de junio
Revisando tutoriales de mummer
si comparo 2 iguales no sale lo que esperaba
Volvi a intentar mauve, el problema parece ser con la version de jdk
En uno de los readme vi mencionar al software BEAST
anteriormente ya habia instalado beast y pude correrlo con java 1.8 por lo que tratare esta version de java
Ya pude abrir mauve, pero algunas de sus funciones tienen bugs
De tdos modos en la alineacíón no se ve practicamente ninguna similitud (7716 & 4101)
intentare con una version mas vieja de java (1.5)
Las versiones que funcionan son 1.6 al 1.9, sin embargo sigue con bugs

Probe GSalign:
para tratar de producir un grafico parecido al de mummer.
Este se me hizo mas confiable porque al alinear dos genomas iguales si me sale una sola linea a diferencia de mummer:
  ./bin/GSAlign -r NZ_AP025018.fa -q NZ_AP025018_or.fa -o gs_align_7716_7716 -dp gs_align_7716_7716_dotplot -gp /home/lalibelulalo/software/gnuplot/bin/gnuplot
Las corridas unicamente las estoy haciendo unicamente con el genoma.
sin embargo al comparar 7716 y 4101 todo se ve diferente.

Debido a que solo se compara una referencia y un query lo ideal seria comparar 2 genomas con abundancia y dos genomas sin abundancia de HIP
no encontre nada.

Halle este recurso, hace graficos de sintenia entre genomas de query y referencia
https://edgar3.computational.bio.uni-giessen.de/cgi-bin/edgar.cgi

18 de Junio
Este otro: https://www.frontiersin.org/articles/10.3389/fmicb.2018.01910/full
http://pgaweb.vlcc.cn/
usa ptts:
https://github.com/ajvilleg/gbk2ptt

pag de recursos de alineacion:
https://molbiol-tools.ca/Alignments.htm

genomicos:
https://molbiol-tools.ca/Genomics.htm

alineameinto:
http://linux1.softberry.com/berry.phtml?topic=index&group=programs&subgroup=scanh

REVISANDO ESTE:
https://genomebiology.biomedcentral.com/articles/10.1186/s13059-014-0524-x

30 de Junio

1.- CONTEO HIP
2.- ARBOL 
3.- NUCMER
4.- GSAlign
5.- MAUVE

./configure --prefix=/home/biocomp/software/gnuplot



./nucmer -p <prefix> ref.fa qry.fa



nucmer -p nuc_Calothrix_sp._336_3_vs_FIRST_100k_INV Calothrix_sp._336_3.fna Calothrix_sp._336_3_100000_inv.fna
show-coords Calothrix_sp._336_3_vs_FIRST_100k_INV.delta > Calothrix_sp._336_3_vs_FIRST_100k_INV.coords
mummerplot -l Calothrix_sp._336_3_vs_FIRST_100k_INV.delta

promer-p prom_Calothrix_sp._336_3_vs_FIRST_100k_INV Calothrix_sp._336_3.fna Calothrix_sp._336_3_100000_inv.fna

dnadiff Calothrix_sp._336_3.fna Calothrix_sp._336_3_100000_inv.fna


GSAlign -r Calothrix_sp._336_3.fna -q Calothrix_sp._336_3_100000_inv.fna -dp -gp /home/lalibelulalo/software/gnuplot/bin/gnuplot -o Calothrix_sp._336_3_vs_FIRST_100k_INV
bwt_index Calothrix_sp._336_3.fna Calothrix_no_inv
GSAlign -i Calothrix_no_inv -q Calothrix_sp._336_3_100000_inv.fna -o Calothrix_sp._336_3_vs_FIRST_100k_INV.output



nucmer -p 20bp_same Genome_fasta_nu_Calothrix_sp._336_3_original_20.fna Genome_fasta_nu_Calothrix_sp._336_3_original_20_same.fna
show-coords 20bp_same.delta > 20bp_same.coords
mummerplot -l 20bp_same.delta



=======CALOTHRIX
LOW VS_LAST:

nucmer -p nuc_4071_low_VS_4101_last Calothrix_sp._NIES-4071_1row_low.fna Calothrix_sp._NIES-4101_1row_last.fna
show-coords nuc_4071_low_VS_4101_last.delta > nuc_4071_low_VS_4101_last.coords
mummerplot -l nuc_4071_low_VS_4101_last.delta

nucmer -p nuc_7716_low_VS_4101_last Calothrix_sp._PCC_7716_1row_low.fna Calothrix_sp._NIES-4101_1row_last.fna
show-coords nuc_7716_low_VS_4101_last.delta > nuc_7716_low_VS_4101_last.coords
mummerplot -l nuc_7716_low_VS_4101_last.delta

LOW:***
nucmer -p nuc_7716_low_VS_4071_low Calothrix_sp._PCC_7716_1row_low.fna Calothrix_sp._NIES-4071_1row_low.fna
show-coords nuc_7716_low_VS_4071_low.delta > nuc_7716_low_VS_4071_low.coords
mummerplot -l nuc_7716_low_VS_4071_low.delta

HIGH LAST 2:*
nucmer -p nuc_4101_last_VS_6303_last2 Calothrix_sp._NIES-4101_1row_last.fna Calothrix_sp._PCC_6303_1row_last2.fna
mkdir nuc_4101_last_VS_6303_last2
mv nuc_4101_last_VS_6303_last2.delta nuc_4101_last_VS_6303_last2
cd nuc_4101_last_VS_6303_last2
show-coords nuc_4101_last_VS_6303_last2.delta > nuc_4101_last_VS_6303_last2.coords
mummerplot -l nuc_4101_last_VS_6303_last2.delta

HIGH LAST 3:
nucmer -p nuc_4101_last_VS_3974_last3 Calothrix_sp._NIES-4101_1row_last.fna Calothrix_sp._NIES-3974_1row_last3.fna
mkdir nuc_4101_last_VS_3974_last3
mv nuc_4101_last_VS_3974_last3.delta nuc_4101_last_VS_3974_last3
cd nuc_4101_last_VS_3974_last3
show-coords nuc_4101_last_VS_3974_last3.delta > nuc_4101_last_VS_3974_last3.coords
mummerplot -l nuc_4101_last_VS_3974_last3.delta


=======LEPTOLYNGBYA
LOW VS HIGH:

nucmer -p nuc_BL0902_low_VS_C2206_high Leptolyngbya_sp._BL0902_1row_low.fna Halomicronema_hongdechloris_C2206_1row_high.fna
mkdir nuc_BL0902_low_VS_C2206_high
mv nuc_BL0902_low_VS_C2206_high.delta nuc_BL0902_low_VS_C2206_high
cd nuc_BL0902_low_VS_C2206_high
show-coords nuc_BL0902_low_VS_C2206_high.delta > nuc_BL0902_low_VS_C2206_high.coords
mummerplot -l nuc_BL0902_low_VS_C2206_high.delta

LOW VS LAST:
nucmer -p nuc_BL0902_low_VS_O-77_1 Leptolyngbya_sp._BL0902_1row_low.fna Leptolyngbya_sp._O-77_1row_1.fna
mkdir nuc_BL0902_low_VS_O-77_1
mv nuc_BL0902_low_VS_O-77_1.delta nuc_BL0902_low_VS_O-77_1
cd nuc_BL0902_low_VS_O-77_1
show-coords nuc_BL0902_low_VS_O-77_1.delta > nuc_BL0902_low_VS_O-77_1.coords
mummerplot -l nuc_BL0902_low_VS_O-77_1.delta

HIGH LAST 2A VS 2B:
nucmer -p nuc_PKUAC-SCTA183_1row_2A_VS_PKUAC-SCTB121_2B Thermoleptolyngbya_sichuanensis_PKUAC-SCTA183_1row_2A.fna Thermoleptolyngbya_sp._PKUAC-SCTB121_1row_2B.fna
mkdir nuc_PKUAC-SCTA183_1row_2A_VS_PKUAC-SCTB121_2B
mv nuc_PKUAC-SCTA183_1row_2A_VS_PKUAC-SCTB121_2B.delta nuc_PKUAC-SCTA183_1row_2A_VS_PKUAC-SCTB121_2B
cd nuc_PKUAC-SCTA183_1row_2A_VS_PKUAC-SCTB121_2B
show-coords nuc_PKUAC-SCTA183_1row_2A_VS_PKUAC-SCTB121_2B.delta > nuc_PKUAC-SCTA183_1row_2A_VS_PKUAC-SCTB121_2B.coords
mummerplot -l nuc_PKUAC-SCTA183_1row_2A_VS_PKUAC-SCTB121_2B.delta

=======SYNECHOCOCCUS
LOW VS HIGH(LAST):

nucmer -p nuc_6312_low_VS_6715_last Synechococcus_sp._PCC_6312_1row_low.fna Synechococcus_lividus_PCC_6715_1row_last.fna
mkdir nuc_6312_low_VS_6715_last
mv nuc_6312_low_VS_6715_last.delta nuc_6312_low_VS_6715_last
cd nuc_6312_low_VS_6715_last
show-coords nuc_6312_low_VS_6715_last.delta > nuc_6312_low_VS_6715_last.coords
mummerplot -l nuc_6312_low_VS_6715_last.delta

LAST VS 1A:
nucmer -p nuc_6715_last_VS_BP-1_1_A Synechococcus_lividus_PCC_6715_1row_last.fna Thermosynechococcus_vestitus_BP-1_1row_1_A.fna
mkdir nuc_6715_last_VS_BP-1_1_A
mv nuc_6715_last_VS_BP-1_1_A.delta nuc_6715_last_VS_BP-1_1_A
cd nuc_6715_last_VS_BP-1_1_A
show-coords nuc_6715_last_VS_BP-1_1_A.delta > nuc_6715_last_VS_BP-1_1_A.coords
mummerplot -l nuc_6715_last_VS_BP-1_1_A.delta

LAST VS 1B:
nucmer -p nuc_6715_last_VS_2134_1B Synechococcus_lividus_PCC_6715_1row_last.fna Thermostichus_vulcanus_NIES-2134_1row_1B.fna
mkdir nuc_6715_last_VS_2134_1B
mv nuc_6715_last_VS_2134_1B.delta nuc_6715_last_VS_2134_1B
cd nuc_6715_last_VS_2134_1B
show-coords nuc_6715_last_VS_2134_1B.delta > nuc_6715_last_VS_2134_1B.coords
mummerplot -l nuc_6715_last_VS_2134_1B.delta

LAST VS 2:
nucmer -p nuc_6715_last_VS_SCTE542_2 Synechococcus_lividus_PCC_6715_1row_last.fna Thermosynechococcus_elongatus_PKUAC-SCTE542_1row_2.fna
mkdir nuc_6715_last_VS_SCTE542_2
mv nuc_6715_last_VS_SCTE542_2.delta nuc_6715_last_VS_SCTE542_2
cd nuc_6715_last_VS_SCTE542_2
show-coords nuc_6715_last_VS_SCTE542_2.delta > nuc_6715_last_VS_SCTE542_2.coords
mummerplot -l nuc_6715_last_VS_SCTE542_2.delta

LAST VS 3A:
nucmer -p nuc_6715_last_VS_CL-1_3A Synechococcus_lividus_PCC_6715_1row_last.fna Thermosynechococcus_sp._CL-1_1row_3A.fna
mkdir nuc_6715_last_VS_CL-1_3A
mv nuc_6715_last_VS_CL-1_3A.delta nuc_6715_last_VS_CL-1_3A
cd nuc_6715_last_VS_CL-1_3A
show-coords nuc_6715_last_VS_CL-1_3A.delta > nuc_6715_last_VS_CL-1_3A.coords
mummerplot -l nuc_6715_last_VS_CL-1_3A.delta

LAST VS 3B:
nucmer -p nuc_6715_last_VS_TA-1_3B Synechococcus_lividus_PCC_6715_1row_last.fna Thermosynechococcus_sp._TA-1_1row_3B.fna
mkdir nuc_6715_last_VS_TA-1_3B
mv nuc_6715_last_VS_TA-1_3B.delta nuc_6715_last_VS_TA-1_3B
cd nuc_6715_last_VS_TA-1_3B
show-coords nuc_6715_last_VS_TA-1_3B.delta > nuc_6715_last_VS_TA-1_3B.coords
mummerplot -l nuc_6715_last_VS_TA-1_3B.delta

######################################################
GSALIGN
LOW's VS LAST
mkdir nuc_4071_low_VS_4101_last
GSAlign -r Calothrix_sp._NIES-4071_1row_low.fna -q Calothrix_sp._NIES-4101_1row_last.fna -dp -o nuc_4071_low_VS_4101_last/nuc_4071_low_VS_4101_last
mv *.sa nuc_4071_low_VS_4101_last
mv *.pac nuc_4071_low_VS_4101_last
mv *.bwt nuc_4071_low_VS_4101_last
mv *.ann nuc_4071_low_VS_4101_last
mv *.amb nuc_4071_low_VS_4101_last
mv GnuPlotPath nuc_4071_low_VS_4101_last


mkdir nuc_7716_low_VS_4101_last
GSAlign -r Calothrix_sp._PCC_7716_1row_low.fna -q Calothrix_sp._NIES-4101_1row_last.fna -dp -o nuc_7716_low_VS_4101_last/nuc_7716_low_VS_4101_last
mv *.sa nuc_7716_low_VS_4101_last
mv *.pac nuc_7716_low_VS_4101_last
mv *.bwt nuc_7716_low_VS_4101_last
mv *.ann nuc_7716_low_VS_4101_last
mv *.amb nuc_7716_low_VS_4101_last
mv GnuPlotPath nuc_7716_low_VS_4101_last


LOW:***
mkdir nuc_7716_low_VS_4071_low
GSAlign -r Calothrix_sp._PCC_7716_1row_low.fna -q Calothrix_sp._NIES-4071_1row_low.fna -dp -o nuc_7716_low_VS_4071_low/nuc_7716_low_VS_4071_low
mv *.sa nuc_7716_low_VS_4071_low
mv *.pac nuc_7716_low_VS_4071_low
mv *.bwt nuc_7716_low_VS_4071_low
mv *.ann nuc_7716_low_VS_4071_low
mv *.amb nuc_7716_low_VS_4071_low
mv GnuPlotPath nuc_7716_low_VS_4071_low

REV***
mkdir nuc_4071_low_VS_VS7716_low
GSAlign -r Calothrix_sp._NIES-4071_1row_low.fna -q Calothrix_sp._PCC_7716_1row_low.fna  -dp -o nuc_4071_low_VS_VS7716_low/nuc_4071_low_VS_VS7716_low
mv *.sa nuc_4071_low_VS_VS7716_low
mv *.pac nuc_4071_low_VS_VS7716_low
mv *.bwt nuc_4071_low_VS_VS7716_low
mv *.ann nuc_4071_low_VS_VS7716_low
mv *.amb nuc_4071_low_VS_VS7716_low
mv GnuPlotPath nuc_4071_low_VS_VS7716_low


HIGH LAST 2:*
nucmer -p nuc_4101_last_VS_6303_last2 Calothrix_sp._NIES-4101_1row_last.fna Calothrix_sp._PCC_6303_1row_last2.fna
mkdir nuc_4101_last_VS_6303_last2
mv nuc_4101_last_VS_6303_last2.delta nuc_4101_last_VS_6303_last2
cd nuc_4101_last_VS_6303_last2
show-coords nuc_4101_last_VS_6303_last2.delta > nuc_4101_last_VS_6303_last2.coords
mummerplot -l nuc_4101_last_VS_6303_last2.delta

HIGH LAST 3:
nucmer -p nuc_4101_last_VS_3974_last3 Calothrix_sp._NIES-4101_1row_last.fna Calothrix_sp._NIES-3974_1row_last3.fna
mkdir nuc_4101_last_VS_3974_last3
mv nuc_4101_last_VS_3974_last3.delta nuc_4101_last_VS_3974_last3
cd nuc_4101_last_VS_3974_last3
show-coords nuc_4101_last_VS_3974_last3.delta > nuc_4101_last_VS_3974_last3.coords
mummerplot -l nuc_4101_last_VS_3974_last3.delta

4 julio
Determinación de ortogrupos:
Este análisis nos permite identificar las familias de ortogrupos que conformen el
pan-genoma de las cianobacterias aquí estudiadas. Este se define como el
conjunto de todas las familias de genes. A su vez, un subconjunto de este, es el
genoma núcleo que contiene solo los genes presentes en todos los genomas
estudiados.

/HIP1/HIP_GETHOMOLOGUES
get_homologues.pl -d calothrix/ -t 0 -M –n PPN

/HIP1/HIP_GETHOMOLOGUES/leptolyngbya
get_homologues.pl -d leptolyngbya_genomes_gbff/ -t 0 -M –n PPN

/HIP1/HIP_GETHOMOLOGUES/synechococcus
get_homologues.pl -d synechococcus_genomes_gbff/ -t 0 -M –n PPN
